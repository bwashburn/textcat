<!DOCTYPE html>
<head>
  <link rel="stylesheet" type="text/css" href="style.css">
  <title>sample1</title>
</head>
<body>
  <div class="instructions">
    <h1>Test Page</h1>
    <p>This page serves both as the source for JsDom within the Jest tests, and as a tool to configure the <strong>getSelection</strong> mock implementation used in the tests. This page has 4 samples to use in the testing, each with the same 40 characters split into different configurations. By selecting a portion of one of the samples and then selecting the <strong>get selection</strong> button, the needed selection properties for mocking a <strong>getSelection</strong> call will be printed to the console.</p>
    <hr>
  </div>
  <br>
  <h2>sample1</h2>
  <div id="sample1" contenteditable="true"><p>ABC<strong>DEF</strong>GHIJ</p><p>1234567890</p><p>ABCDEFGHIJ</p><p>1234567890</p></div>
  <br>
  <h2>sample2</h2>
  <div id="sample2" contenteditable="true">
    <p>ABC<strong>DEF</strong>GHIJ</p>
    <p>1234567890</p>
    <p>ABCDEFGHIJ</p>
    <p>1234567890</p>
  </div>
  <br>
  <h2>sample3</h2>
  <div id="sample3" contenteditable="true">
    <p>ABCDEFGHIJ</p>
    <p>1234567890</p>
    <p>ABCDEFGHIJ</p>
    <p>1234567890</p>
  </div>
  <br>
  <h2>sample4</h2>
  <div id="sample4" contenteditable="true">
    <h2>ABCDEFGHIJ</h2>
    <p>123<strong>456</strong>7890</p>
    <ul>
      <li>abc</li>
      <li>def<ul>
          <li>ghi</li>
          <li>j</li>
        </ul>
      </li>
    </ul>
    <p>ABCDEFGHIJ</p>
    <p>1234567890</p>
  </div>
  <br>
  <h2>sample5</h2>
  <div id="sample5" contenteditable="true">
    <h2>ABCDEFGHIJ</h2>
    <p>123<strong>456</strong>7890</p>
    <p>ABCDEFGHIJ</p>
    <ul>
      <li>abc</li>
      <li>def</li>
      <li>ghi</li>
      <li>j</li>
      <li>123</li>
      <li>456</li>
      <li>789</li>
      <li>0</li>
    </ul>
  </div>
  <br>
  <button id="btn">get selection</button>
  <script>
    let containerType = ['article', 'aside', 'div', 'footer', 'header', 'main', 'section']
    document.getElementById('btn').addEventListener('click', displaySelection)

    function displaySelection () {
      let { anchorNode, anchorOffset, focusNode, focusOffset }  = window.getSelection()

      let anchorArray = []
      let anchorParent = anchorNode.parentNode
      anchorArray.push(Array.from(anchorParent.childNodes).indexOf(anchorNode))
      while (!containerType.includes(anchorParent.localName)) {
        anchorArray.unshift(Array.from(anchorParent.parentNode.childNodes).indexOf(anchorParent))
        anchorParent = anchorParent.parentNode
      }

      let focusArray = []
      let focusParent = focusNode.parentNode
      focusArray.push(Array.from(focusParent.childNodes).indexOf(focusNode))
      while (!containerType.includes(focusParent.localName)) {
        focusArray.unshift(Array.from(focusParent.parentNode.childNodes).indexOf(focusParent))
        focusParent = focusParent.parentNode
      }

      let anchorString = 'anchorNode: sample'
      for (let i = 0; i < anchorArray.length; i++) {
        anchorString += '.childNodes[' + anchorArray[i] + ']'
      }

      let focusString = 'focusNode: sample'
      for (let j = 0; j < focusArray.length; j++) {
        focusString += '.childNodes[' + focusArray[j] + ']'
      }
      console.log(anchorParent.id)
      console.log(anchorString)
      console.log('anchorOffset: ' + anchorOffset)
      console.log(focusString)
      console.log('focusOffset: ' + focusOffset)
    }
  </script>
</body>